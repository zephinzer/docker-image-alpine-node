#!/bin/bash
TAG_NAME=$1;
NODE_VERSION=$(cat ./${TAG_NAME}.Version);
if [[ $? != "0" ]]; then exit 1; fi;
EXISTENCE_CHECK=$(curl --silent -f -lSL https://index.docker.io/v1/repositories/zephinzer/alpine-node/tags/${NODE_VERSION});
if [[ $? != "0" ]]; then
  docker build -t next -f ${TAG_NAME}.Dockerfile .;
  docker tag next  ${DOCKER_REPO}:${NODE_VERSION};
  docker push      ${DOCKER_REPO}:${NODE_VERSION};
  docker tag next  ${DOCKER_REPO}:latest-${TAG_NAME};
  docker push      ${DOCKER_REPO}:latest-${TAG_NAME};
fi;
./scripts/build/teardown;